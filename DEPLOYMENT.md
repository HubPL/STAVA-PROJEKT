# 🚀 STAVA - Deployment Guide

## 📋 Pre-deployment Checklist

### ✅ **Environment Variables Required:**

```bash
# Firebase Configuration
NEXT_PUBLIC_FIREBASE_API_KEY=your_firebase_api_key
NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN=stava-project.firebaseapp.com
NEXT_PUBLIC_FIREBASE_PROJECT_ID=stava-project
NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET=stava-project.appspot.com
NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID=123456789
NEXT_PUBLIC_FIREBASE_APP_ID=1:123456789:web:abcdef

# Email (Resend API)
RESEND_API_KEY=re_xxxxxxxxxx
EMAIL_FROM=noreply@stavakiszewa.pl
EMAIL_ADMIN=kontakt@stavakiszewa.pl

# App Settings
NEXT_PUBLIC_APP_URL=https://stavakiszewa.pl
NEXT_PUBLIC_APP_NAME=STAVA Kiszewa

# SMS (Optional)
SMS_API_TOKEN=your_sms_token
ADMIN_PHONE=+48886627447
SMS_SENDER=STAVA

# Security
CLEANUP_API_KEY=secure_random_string_for_cleanup_cron
```

## 🛠️ **Build Optimizations Applied:**

### Performance ⚡
- ✅ Lazy loading dla komponentów (CookieConsent, Lightbox, Calendar)
- ✅ Advanced Image optimization z Intersection Observer
- ✅ Bundle optimization (react-icons, date-fns)
- ✅ CSS optimization enabled
- ✅ SWC minification
- ✅ Production-safe logging

### SEO 📈
- ✅ Complete meta tags na wszystkich stronach
- ✅ Structured data (Business, FAQ, Breadcrumbs)
- ✅ Optimized sitemap.xml
- ✅ Proper robots.txt
- ✅ Canonical URLs i hreflang
- ✅ OpenGraph i Twitter Cards

### Security 🔒
- ✅ Security headers (CSP, HSTS, X-Frame-Options)
- ✅ Firebase rules properly configured
- ✅ API endpoints protected
- ✅ No exposed secrets in code

### Caching 📦
- ✅ Image caching (1 year)
- ✅ Font caching (1 year)  
- ✅ API cache headers
- ✅ Browser caching optimized

## 🚀 **Deployment Steps:**

### 1. Vercel Deployment
```bash
# Install Vercel CLI
npm i -g vercel

# Deploy
vercel --prod

# Set environment variables
vercel env add NEXT_PUBLIC_FIREBASE_API_KEY
vercel env add RESEND_API_KEY
# ... (add all variables from list above)
```

### 2. Firebase Setup
```bash
# Make sure Firebase rules are deployed
firebase deploy --only firestore:rules
firebase deploy --only storage
```

### 3. DNS Configuration
- ✅ CNAME: www → stavakiszewa.pl
- ✅ A record: @ → Vercel IP
- ✅ SSL Certificate auto-generated by Vercel

### 4. Post-deployment Testing
- [ ] Test reservation flow
- [ ] Test admin panel login
- [ ] Test email sending
- [ ] Test image loading
- [ ] Test mobile responsiveness
- [ ] Run Lighthouse audit
- [ ] Check Google Search Console

## 📊 **Performance Targets:**

### Lighthouse Scores (Target):
- 🎯 Performance: 90+
- 🎯 Accessibility: 95+
- 🎯 Best Practices: 95+
- 🎯 SEO: 100

### Core Web Vitals:
- 🎯 LCP (Largest Contentful Paint): < 2.5s
- 🎯 FID (First Input Delay): < 100ms  
- 🎯 CLS (Cumulative Layout Shift): < 0.1

## 🔧 **Monitoring Setup:**

### 1. Error Tracking
- Vercel Analytics już skonfigurowane
- Vercel Speed Insights włączone

### 2. Uptime Monitoring
- Set up external monitoring (UptimeRobot/Pingdom)
- Monitor critical endpoints:
  - `/` (homepage)
  - `/rezerwacja` (booking)
  - `/api/contact` (email API)

### 3. SEO Monitoring
- Google Search Console
- Google Analytics 4
- Monitor keyword rankings

## ⚡ **Performance Features Implemented:**

1. **Image Optimization:**
   - WebP/AVIF formats
   - Lazy loading with Intersection Observer
   - Proper sizing and compression

2. **Code Splitting:**
   - Dynamic imports for heavy components
   - Suspense boundaries
   - Bundle optimization

3. **Caching Strategy:**
   - Static assets: 1 year cache
   - API routes: no-cache
   - Images: immutable caching

4. **SEO Enhancements:**
   - Dynamic meta tags generator
   - Structured data helpers
   - Complete sitemap with priorities

## 🐛 **Common Issues & Solutions:**

### Firebase Storage CORS
If images don't load:
```bash
gsutil cors set cors.json gs://your-bucket-name
```

### Email Delivery Issues
- Check Resend API key
- Verify sender domain
- Check DNS SPF/DKIM records

### Build Errors
- Clear `.next` folder: `rm -rf .next`
- Update dependencies: `npm update`
- Check environment variables

---

**🎉 Ready for production!** The app is optimized for performance, SEO, and security.